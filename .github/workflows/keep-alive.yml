# Keep Render free-tier web service from spinning down (15 min idle).
# Pings the /health endpoint every 14 minutes so the service stays awake.
# Requires: Add secret RENDER_SERVICE_URL (e.g. https://your-app.onrender.com) in repo Settings â†’ Secrets.

name: Keep Render alive

on:
  schedule:
    # Every 14 minutes (under Render's 15 min idle threshold). Uses UTC.
    - cron: '*/14 * * * *'
  workflow_dispatch: # Allow manual run from Actions tab

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping health endpoint
        run: |
          if [ -z "${{ secrets.RENDER_SERVICE_URL }}" ]; then
            echo "RENDER_SERVICE_URL secret is not set. Skipping ping."
            exit 0
          fi
          url="${{ secrets.RENDER_SERVICE_URL }}"
          url="${url%/}"
          curl -sf --max-time 120 "${url}/health" || true
        env: {}
